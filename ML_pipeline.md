
# Preparing elasticsearch data for ML analytics.
![enter image description here](https://github.com/adrianliaviatrix/images/blob/main/data%20preprocessing.png)
## Flattened data Schema in step (3)
### **Netflow data:**

    root  
    |-- _id: string (nullable = true)  
    |-- _index: string (nullable = true)  
    |-- _score: long (nullable = true)  
    |-- _type: string (nullable = true)  
    |-- _source>@timestamp: string (nullable = true)  
    |-- _source>@version: string (nullable = true)  
    |-- _source>host: string (nullable = true)  
    |-- _source>type: string (nullable = true)  
    |-- _source>geoip_dst>autonomous_system: string (nullable = true)  
    |-- _source>geoip_src>autonomous_system: string (nullable = true)  
    |-- _source>netflow>bytes: long (nullable = true)  
    |-- _source>netflow>direction: string (nullable = true)  
    |-- _source>netflow>dst_addr: string (nullable = true)  
    |-- _source>netflow>dst_locality: string (nullable = true)  
    |-- _source>netflow>dst_mac: string (nullable = true)  
    |-- _source>netflow>dst_port: long (nullable = true)  
    |-- _source>netflow>egressInterfaceName: string (nullable = true)  
    |-- _source>netflow>egressPhysicalInterface: long (nullable = true)  
    |-- _source>netflow>ethernetType: long (nullable = true)  
    |-- _source>netflow>first_switched: string (nullable = true)  
    |-- _source>netflow>flow_locality: string (nullable = true)  
    |-- _source>netflow>flow_seq_num: long (nullable = true)  
    |-- _source>netflow>flowset_id: long (nullable = true)  
    |-- _source>netflow>ingressInterfaceName: string (nullable = true)  
    |-- _source>netflow>ingressPhysicalInterface: long (nullable = true)  
    |-- _source>netflow>input_snmp: long (nullable = true)  
    |-- _source>netflow>ip_protocol_version: long (nullable = true)  
    |-- _source>netflow>ip_version: string (nullable = true)  
    |-- _source>netflow>last_switched: string (nullable = true)  
    |-- _source>netflow>next_hop: string (nullable = true)  
    |-- _source>netflow>output_snmp: long (nullable = true)  
    |-- _source>netflow>packets: long (nullable = true)  
    |-- _source>netflow>protocol: long (nullable = true)  
    |-- _source>netflow>protocol_name: string (nullable = true)  
    |-- _source>netflow>src_addr: string (nullable = true)  
    |-- _source>netflow>src_locality: string (nullable = true)  
    |-- _source>netflow>src_mac: string (nullable = true)  
    |-- _source>netflow>src_port: long (nullable = true)  
    |-- _source>netflow>tos: long (nullable = true)  
    |-- _source>netflow>version: string (nullable = true)

    sudo service elasticsearch restart
    sudo systemctl status elasticsearch.service
    sudo less /var/log/elasticsearch/elasticsearch.log
### perfmon data: 

    root  
    |-- _id: string (nullable = true)  
    |-- _index: string (nullable = true)  
    |-- _score: long (nullable = true)  
    |-- _type: string (nullable = true)  
    |-- _source>@timestamp: string (nullable = true)  
    |-- _source>@version: string (nullable = true)  
    |-- _source>gatewayName: string (nullable = true)  
    |-- _source>tags: string (nullable = true)  
    |-- _source>ifstats>destinationGateway: string (nullable = true)  
    |-- _source>ifstats>interfaceName: string (nullable = true)  
    |-- _source>ifstats>state: string (nullable = true)  
    |-- _source>misc_stats>conntrack_count: long (nullable = true)  
    |-- _source>misc_stats>xfrm_inbound_error_cnt: long (nullable = true)  
    |-- _source>misc_stats>xfrm_outbound_error_cnt: long (nullable = true)  
    |-- _source>mpstats>cpu_idle: long (nullable = true)  
    |-- _source>mpstats>cpu_ks: long (nullable = true)  
    |-- _source>mpstats>cpu_steal: long (nullable = true)  
    |-- _source>mpstats>cpu_us: long (nullable = true)  
    |-- _source>mpstats>cpu_wait: long (nullable = true)  
    |-- _source>mpstats>hdisk_free: long (nullable = true)  
    |-- _source>mpstats>hdisk_tot: long (nullable = true)  
    |-- _source>mpstats>io_blk_in: long (nullable = true)  
    |-- _source>mpstats>io_blk_out: long (nullable = true)  
    |-- _source>mpstats>memory_buf: long (nullable = true)  
    |-- _source>mpstats>memory_cached: long (nullable = true)  
    |-- _source>mpstats>memory_free: long (nullable = true)  
    |-- _source>mpstats>memory_swpd: long (nullable = true)  
    |-- _source>mpstats>nproc_non_int_sleep: long (nullable = true)  
    |-- _source>mpstats>nproc_running: long (nullable = true)  
    |-- _source>mpstats>swap_from_disk: long (nullable = true)  
    |-- _source>mpstats>swap_to_disk: long (nullable = true)  
    |-- _source>mpstats>system_cs: long (nullable = true)  
    |-- _source>mpstats>system_int: long (nullable = true)  
    |-- _source>ifstats>stats>bandwidth_egress_limit_exceeded: long (nullable = true)  
    |-- _source>ifstats>stats>bandwidth_ingress_limit_exceeded: long (nullable = true)  
    |-- _source>ifstats>stats>conntrack_limit_exceeded: long (nullable = true)  
    |-- _source>ifstats>stats>linklocal_limit_exceeded: long (nullable = true)  
    |-- _source>ifstats>stats>pkt_rate_total: double (nullable = true)  
    |-- _source>ifstats>stats>pkt_rx_rate: double (nullable = true)  
    |-- _source>ifstats>stats>pkt_tx_rate: double (nullable = true)  
    |-- _source>ifstats>stats>pps_limit_exceeded: long (nullable = true)  
    |-- _source>ifstats>stats>rate_bandwidth_egress_limit_exceeded: long (nullable = true)  
    |-- _source>ifstats>stats>rate_bandwidth_ingress_limit_exceeded: long (nullable = true)  
    |-- _source>ifstats>stats>rate_conntrack_limit_exceeded: long (nullable = true)  
    |-- _source>ifstats>stats>rate_linklocal_limit_exceeded: long (nullable = true)  
    |-- _source>ifstats>stats>rate_peak_received: double (nullable = true)  
    |-- _source>ifstats>stats>rate_peak_sent: double (nullable = true)  
    |-- _source>ifstats>stats>rate_peak_total: double (nullable = true)  
    |-- _source>ifstats>stats>rate_pps_limit_exceeded: long (nullable = true)  
    |-- _source>ifstats>stats>rate_received: double (nullable = true)  
    |-- _source>ifstats>stats>rate_rx_compressed: long (nullable = true)  
    |-- _source>ifstats>stats>rate_rx_drop: long (nullable = true)  
    |-- _source>ifstats>stats>rate_rx_errs: long (nullable = true)  
    |-- _source>ifstats>stats>rate_rx_fifo: long (nullable = true)  
    |-- _source>ifstats>stats>rate_rx_frame: long (nullable = true)  
    |-- _source>ifstats>stats>rate_rx_multicast: long (nullable = true)  
    |-- _source>ifstats>stats>rate_sent: double (nullable = true)  
    |-- _source>ifstats>stats>rate_total: double (nullable = true)  
    |-- _source>ifstats>stats>rate_tx_carrier: long (nullable = true)  
    |-- _source>ifstats>stats>rate_tx_colls: long (nullable = true)  
    |-- _source>ifstats>stats>rate_tx_compressed: long (nullable = true)  
    |-- _source>ifstats>stats>rate_tx_drop: long (nullable = true)  
    |-- _source>ifstats>stats>rate_tx_errs: long (nullable = true)  
    |-- _source>ifstats>stats>rate_tx_fifo: long (nullable = true)  
    |-- _source>ifstats>stats>rx_bytes: long (nullable = true)  
    |-- _source>ifstats>stats>rx_compressed: long (nullable = true)  
    |-- _source>ifstats>stats>rx_drop: long (nullable = true)  
    |-- _source>ifstats>stats>rx_errs: long (nullable = true)  
    |-- _source>ifstats>stats>rx_fifo: long (nullable = true)  
    |-- _source>ifstats>stats>rx_frame: long (nullable = true)  
    |-- _source>ifstats>stats>rx_multicast: long (nullable = true)  
    |-- _source>ifstats>stats>rx_packets: long (nullable = true)  
    |-- _source>ifstats>stats>tx_bytes: long (nullable = true)  
    |-- _source>ifstats>stats>tx_carrier: long (nullable = true)  
    |-- _source>ifstats>stats>tx_colls: long (nullable = true)  
    |-- _source>ifstats>stats>tx_compressed: long (nullable = true)  
    |-- _source>ifstats>stats>tx_drop: long (nullable = true)  
    |-- _source>ifstats>stats>tx_errs: long (nullable = true)  
    |-- _source>ifstats>stats>tx_fifo: long (nullable = true)  
    |-- _source>ifstats>stats>tx_packets: long (nullable = true)


### avx-latency data:

    root  
    |-- _id: string (nullable = true)  
    |-- _index: string (nullable = true)  
    |-- _score: long (nullable = true)  
    |-- _type: string (nullable = true)  
    |-- _source>@timestamp: string (nullable = true)  
    |-- _source>@version: string (nullable = true)  
    |-- _source>dstGw: string (nullable = true)  
    |-- _source>edgeId: string (nullable = true)  
    |-- _source>latency: double (nullable = true)  
    |-- _source>srcGw: string (nullable = true)  
    |-- _source>tags: string (nullable = true)

### cmd data:

    root  
    |-- _id: string (nullable = true)  
    |-- _ignored: string (nullable = true)  
    |-- _index: string (nullable = true)  
    |-- _score: long (nullable = true)  
    |-- _type: string (nullable = true)  
    |-- _source>@timestamp: string (nullable = true)  
    |-- _source>@version: string (nullable = true)  
    |-- _source>action: string (nullable = true)  
    |-- _source>args: string (nullable = true)  
    |-- _source>host: string (nullable = true)  
    |-- _source>message: string (nullable = true)  
    |-- _source>reason: string (nullable = true)  
    |-- _source>result: string (nullable = true)  
    |-- _source>tags: string (nullable = true)  
    |-- _source>type: string (nullable = true)  
    |-- _source>username: string (nullable = true)


